
get_known_csv_files() {
    // add here the custom CSV you want:
    custom_csv = array(
        "acts/test_injection.csv",
        "gamedata/weapons/common/weaponoptions.csv"
    );


    res = array(
        "gamedata/loot/mplootemblems.csv",
        "gamedata/loot/mpUnreleasedLoot.csv",
        "gamedata/tables/common/music_player.csv",
        "gamedata/events/reserve_deals_schedule_xbox.csv",
        "gamedata/events/reserve_deals_schedule_ps4.csv",
        "gamedata/loot/mplootitems.csv",
        "gamedata/tables/cp/cp_vehicleHacks.csv",
        "gamedata/tables/common/consumables.csv",
        "gamedata/events/itemshop_slot_1_ps4.csv",
        "gamedata/events/itemshop_slot_2_ps4.csv",
        "gamedata/events/itemshop_slot_3_ps4.csv",
        "gamedata/events/itemshop_slot_4_ps4.csv",
        "gamedata/events/itemshop_slot_5_ps4.csv",
        "gamedata/events/itemshop_slot_6_ps4.csv",
        "gamedata/events/itemshop_slot_1_xbox.csv",
        "gamedata/events/itemshop_slot_2_xbox.csv",
        "gamedata/events/itemshop_slot_3_xbox.csv",
        "gamedata/events/itemshop_slot_4_xbox.csv",
        "gamedata/events/itemshop_slot_5_xbox.csv",
        "gamedata/events/itemshop_slot_6_xbox.csv",

        "gamedata/tables/sp/badwords.csv",
        "gamedata/tables/common/badclantags.csv",
        "gamedata/tables/common/goodwords.csv",
        "qosconfig4.csv",
        "fonticon/defaultFontIcon.csv",
        "gamedata/tables/common/defaultStringTable.csv",
        "gamedata/tables/common/shadows_map_override.csv",
        "gamedata/tables/common/htmlStyle.csv",
        "/streamer/usage.csv",
        "gamedata/fileshare/fileshare_categories.csv",
        "gamedata/tables/common/inventory_currency.csv",
        "gamedata/tables/common/inventory_items.csv",
        "gamedata/tables/common/consumables.csv",
        "gamedata/tables/common/doublexpgroups.csv",
        "gamedata/store/common/incentives.csv",
        "gamedata/loot/zmlootitems.csv",
        "gamedata/loot/mplootitems.csv",
        "gamedata/loot/loot_crate.csv",
        "gamedata/fileshare/fileshare_categories.csv",
        "leaderboards/mp_custom_leaderboards_reset.csv",
        "gamedata/tables/common/gamertags.csv",
        "gamedata/storage/storage_validation.csv",
        "gamedata/store/common/storeconfig.csv",
        "gamedata/store/common/fpentitlement.csv",
        "gamedata/configstrings/%s.csv",
        "gamedata/stats/cp/cp_statscheck.csv",
        "gamedata/stats/cp/cp_statdeltas.csv",
        "gamedata/tables/cp/scoreinfo/cp_scoreinfo_base.csv",
        "gamedata/weapons/cp/cp_attributesTable.csv",
        "gamedata/tables/cp/cp_factiontable.csv",
        "gamedata/tables/cp/cp_highlightReelInfoDefines.csv",
        "gamedata/tables/cp/cp_highlightReelStarLevels.csv",
        "gamedata/tables/cp/cp_mapMissions.csv",
        "gamedata/stats/mp/mp_statscheck.csv",
        "gamedata/stats/mp/mp_statdeltas.csv",
        "gamedata/tables/mp/scoreinfo/mp_scoreinfo_base.csv",
        "gamedata/weapons/mp/mp_attributesTable.csv",
        "gamedata/tables/mp/mp_factiontable.csv",
        "gamedata/tables/mp/mp_highlightReelInfoDefines.csv",
        "gamedata/tables/mp/mp_highlightReelStarLevels.csv",
        "gamedata/tables/mp/arena_seasons.csv",
        "gamedata/stats/zm/zm_statscheck.csv",
        "gamedata/stats/zm/zm_statdeltas.csv",
        "gamedata/tables/zm/scoreinfo/zm_scoreinfo_base.csv",
        "gamedata/tables/zm/zm_factiontable.csv",
        "gamedata/tables/zm/zm_highlightReelInfoDefines.csv",
        "gamedata/tables/zm/zm_highlightReelStarLevels.csv",
        "gamedata/tables/common/globalcounters.csv",
        "gamedata/tables/common/globalCounterRefs.csv",
        "gamedata/tables/common/trackercolumns.csv",
        "gamedata/weapons/mp/mp_gunlevels.csv",
        "gamedata/stats/mp/mp_statstable.csv",
        "gamedata/tables/mp/mp_unlockmapping.csv",
        "gamedata/tables/mp/mp_ranktable.csv",
        "gamedata/tables/mp/mp_rankicontable.csv",
        "gamedata/tables/mp/mp_paragonranktable.csv",
        "gamedata/tables/mp/mp_paragonrankicontable.csv",
        "gamedata/tables/mp/mp_levelpointtable.csv",
        "gamedata/stats/mp/statsmilestones1.csv",
        "gamedata/stats/mp/statsmilestones2.csv",
        "gamedata/stats/mp/statsmilestones3.csv",
        "gamedata/stats/mp/statsmilestones4.csv",
        "gamedata/stats/mp/statsmilestones5.csv",
        "gamedata/stats/mp/statsmilestones6.csv",
        "gamedata/weapons/cp/cp_gunlevels.csv",
        "gamedata/stats/cp/cp_statstable.csv",
        "gamedata/tables/cp/cp_unlockmapping.csv",
        "gamedata/tables/cp/cp_ranktable.csv",
        "gamedata/tables/cp/cp_rankicontable.csv",
        "gamedata/stats/cp/statsmilestones1.csv",
        "gamedata/stats/cp/statsmilestones2.csv",
        "gamedata/stats/cp/statsmilestones3.csv",
        "gamedata/stats/cp/statsmilestones4.csv",
        "gamedata/stats/cp/statsmilestones5.csv"
    );
    arr2 = array(
        "gamedata/stats/cp/statsmilestones6.csv",
        "gamedata/weapons/zm/zm_gunlevels.csv",
        "gamedata/stats/zm/zm_statstable.csv",
        "gamedata/tables/zm/zm_unlockmapping.csv",
        "gamedata/tables/zm/zm_ranktable.csv",
        "gamedata/tables/zm/zm_rankicontable.csv",
        "gamedata/tables/zm/zm_paragonranktable.csv",
        "gamedata/tables/zm/zm_paragonrankicontable.csv",
        "gamedata/tables/zm/zm_dailychallengesutc.csv",
        "gamedata/stats/zm/statsmilestones1.csv",
        "gamedata/stats/zm/statsmilestones2.csv",
        "gamedata/stats/zm/statsmilestones3.csv",
        "gamedata/stats/zm/statsmilestones4.csv",
        "gamedata/stats/zm/statsmilestones5.csv",
        "gamedata/stats/zm/statsmilestones6.csv",
        "gamedata/tables/common/mtxitems.csv",
        "gamedata/weapons/common/attachmenttable.csv",
        "gamedata/weapons/common/attachmentmappingstable.csv",
        "gamedata/tables/common/music_player.csv",
        "gamedata/tables/common/live_event_streamers.csv",
        "gamedata/tables/common/globalpolls.csv",
        "local_storage/user/taskmanagerdump.csv",
        "gamedata/emblems/emblemSwatchColors.csv",
        "gamedata/emblems/emblemCategoriesOrLayers.csv",
        "gamedata/emblems/emblemIcons.csv",
        "gamedata/emblems/backgrounds.csv",
        "gamedata/emblems/emblemMaterials.csv",
        "gamedata/emblems/paintshopIconPositions.csv",
        "gamedata/tables/common/clantagfeatures.csv",
        #"hash_41c3d60c9fdc1c1a", // audio all maps
        #"hash_6d9aadb58948623b", // audio escape, office, white
        #"hash_5513a399a5c36320", // audio escape
        #"hash_c79aaf74e007b22",  // audio mansion
        #"hash_74c49b8d4f407798", // audio mansion
        #"hash_75b01784227cb52f", // audio office
        #"hash_6a57c10f8d76df9e", // audio orange
        #"hash_50f83dce1a50995",  // audio orange
        #"hash_5963a3db3032ab46", // audio red, towers
        #"hash_37db46ab64d46fca", // audio red
        #"hash_54bad987adb5e01d", // towers
        #"hash_2a32b98080f6388",  // white
        #"hash_5ec1825aeab754a2", // character banter
        #"hash_241c0e86d7b363e9", // weapon table level zm_escape
        #"hash_67972fca091f2c13", // weapon table level zm_mansion
        #"hash_2ed6ad41883dc026", // weapon table level zm_office
        #"hash_544f128e274c84e0", // weapon table level zm_orange
        #"hash_27415a2cb947e75", // weapon table level zm_red
        #"hash_42dcec7533a676b0", // weapon table level zm_towers
        #"hash_6dcfc619b819ab4f", // weapon table level zm_white
        #"hash_3180c9ba4da02927", // weapon table level zm_zodt8
        #"hash_5694d3fa5334f8fe", // weapon table 1
        #"hash_3f8d28bb3d9e9bec", // weapon table 2
        #"hash_7bda40310359350e" // weapon table default
    );
    foreach (e in arr2) {
        array::add(res, e); // the array function doesn't work above 100 elements
    }
    foreach (e in custom_csv) {
        array::add(res, e);
    }


	if(sessionmodeiscampaigngame()) {
		prefix = #"hash_3bebadbc9db1102b";
	} else if(sessionmodeiszombiesgame()) {
        prefix = #"hash_5f114025234e912f";
    } else if(sessionmodeiswarzonegame()) {
		prefix = #"hash_2bedaa060f1bcc0f";
	} else {
        prefix = #"hash_44588d37c7fe1bf3";
    }

    gametype = level.gametype;

    if (isdefined(gametype)) {
        gametype = strreplace(gametype, "_hc", "");
        gametype = strreplace(gametype, "_cwl", "");
        gametype = strreplace(gametype, "_bb", "");
	    tablename = prefix + "_" + gametype + ".csv";
        array::add(res, tablename, true);
    }
    tablename = prefix + "_base.csv";
    array::add(res, tablename, true);

    tablename = "gamedata/tables/mp/" + level.script + "_ph.csv";
    array::add(res, tablename, true);
	
    if(sessionmodeiszombiesgame()) {
        array::add(res, #"hash_76ee9df26d2df66a", true);
	    trial_variant = getgametypesetting(#"zmtrialsvariant");
        
        if (isdefined(trial_variant) && trial_variant > 0) {
            tablename = "gamedata/tables/zm/" + level.script + "_trials_variant_" + trial_variant + ".csv";
        } else {
            tablename = "gamedata/tables/zm/" + level.script + "_trials.csv";
        }
        array::add(res, tablename, true);
    }
    return res;
}
func_csv_explorer_tab2(menu) {
    menu.sub_menus = array();
    // dynamically loaded script, we can't assume no runtime update
#ifdef ATIAN_COD_TOOL
    self add_menu(menu.id + "_c_acts", "acts/test_injection.csv", menu.id, true, &func_csv_explorer, "acts/test_injection.csv");
    self add_menu(menu.id + "_c_acts", "events_schedule.csv", menu.id, true, &func_csv_explorer, "gamedata/events/schedule_pc.csv");
#endif
}

func_csv_explorer_tab(menu) {
    if (isdefined(menu.sub_menus) && menu.sub_menus.size != 0) {
        // already done, I assume a CSV can't be updated at runtime
        return; 
    }
    menu.sub_menus = array();

#ifdef ATIAN_COD_TOOL
    self add_menu(menu.id + "_c_acts", "acts/test_injection.csv", menu.id, true, &func_csv_explorer, "acts/test_injection.csv");
#endif

    csv_files = get_known_csv_files();

    for (i = 0; i < csv_files.size; i++) {
        asset = csv_files[i];
        v = isassetloaded("stringtable", asset);

        if (!(isdefined(v) && v)) {
            continue; // not loaded
        }

        if (ishash(asset)) {
            name = hash_lookup(asset);
        } else {
            name = asset;
        }
        self add_menu(menu.id + "_c_" + i, get_csv_file_title(name), menu.id, true, &func_csv_explorer, asset);
    }
}

func_csv_explorer(menu, tablename) {
    if (isdefined(menu.sub_menus) && menu.sub_menus.size != 0) {
        return; 
    }
    menu.sub_menus = array();

    rows = tablelookuprowcount(tablename);

    if (!isdefined(rows)) {
        self add_menu_item(menu.id, "no info");
        return;
    }

    for (i = 0; i < rows; i++) {
        self add_menu(menu.id + "_r_" + i, "Row " + i, menu.id, true, &func_csv_row_explorer, tablename, i);
    }
}

func_csv_row_explorer(menu, tablename, row) {
    if (isdefined(menu.sub_menus) && menu.sub_menus.size != 0) {
        return; 
    }
    menu.sub_menus = array();

    columns = tablelookupcolumncount(tablename);

    for (i = 0; i < columns; i++) {
        val = tablelookupcolumnforrow(tablename, row, i);
        self add_menu_item(menu.id, i + ":" + get_object_type(val));
    }
}